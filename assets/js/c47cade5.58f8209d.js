(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[967],{620:function(e,n,t){"use strict";t.d(n,{nR:function(){return r}});var a=t(7294),i=t(7312),o=t(8989),r=function(e){var n,t,r,l,s,p,d,u,c,m=function(e){return Object.assign({fileType:"php",examplePurpose:e.summary},e)}(Object.assign({examplePurpose:null!=(n=null==e?void 0:e.summary)?n:null},e));(m.description=(r=m,l=null!=(t=null==m?void 0:m.defaultDescription)?t:null,s=r.description,p=void 0===s?null:s,d=r.extraDescription,u=void 0===d?null:d,p||(!1===p?null:a.createElement(a.Fragment,null,a.createElement(l,null),u))),null!=m&&m.example||null!=m&&m.defaultExample)&&(m.example=(0,o.W7)(m,null!=(c=null==m?void 0:m.defaultExample)?c:null));return(0,i.nR)(m)}},9742:function(e,n,t){"use strict";t.d(n,{D5:function(){return u},dk:function(){return g},i9:function(){return y},Jk:function(){return x},Id:function(){return P},MC:function(){return A},tw:function(){return S},_n:function(){return H},c5:function(){return O},Hg:function(){return q},BO:function(){return J},L5:function(){return ne},oI:function(){return oe},sY:function(){return pe},T5:function(){return me},ss:function(){return ve},Uo:function(){return we},Gf:function(){return Ee},KQ:function(){return Te},Y1:function(){return Ze},J$:function(){return Xe},t5:function(){return ze},Wy:function(){return Ge},dU:function(){return je},NA:function(){return Qe},f_:function(){return an},My:function(){return sn}});var a=t(7462),i=t(7294),o=t(620),r=t(3366),l=t(3905),s=["components"],p={toc:[]};function d(e){var n=e.components,t=(0,r.Z)(e,s);return(0,l.kt)("wrapper",(0,a.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"JavaScript in Moodle is written in the ESM format, and transpiled into AMD modules for deployment."),(0,l.kt)("p",null,"The ",(0,l.kt)("a",{parentName:"p",href:"../guides/javascript"},"Moodle JavaScript Guide")," has detailed information and examples on writing JavaScript in Moodle. Further information is also available in the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Javascript%20Modules"},"Javascript Modules")," documentation."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Although the AMD module format is supported, all new JavaScript is written in the EcmaScript Module (ESM) format."))))}d.isMDXComponent=!0;var u=function(e){return i.createElement(o.nR,(0,a.Z)({required:!0,defaultDescription:d,defaultExample:"\nimport {fetchThings} from './repository';\n\nexport const updateThings = (thingData) => {\n    return fetchThings(thingData);\n};\n",examplePurpose:"Example module",filepath:"/amd/src/example.js",filetype:"js",modulename:"example",summary:"AMD JavaScript Modules"},e))},c=["components"],m={toc:[]};function h(e){var n=e.components,t=(0,r.Z)(e,c);return(0,l.kt)("wrapper",(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"If your plugin stores data then you may need to implement the Backup feature which allows the activity to backed up, restored, and duplicated."),(0,l.kt)("p",null,"For more information on Backup and restore, see the following:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Backup_2.0_for_developers"},"Backup 2.0 for developers"),""),(0,l.kt)("li",{parentName:"ul"},"",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Restore_2.0_for_developers"},"Restore 2.0 for developers"),"")))}h.isMDXComponent=!0;var g=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/backup/",summary:"Plugin Backup configuration",defaultDescription:h},e))},f=["components"],v={toc:[]};function k(e){var n=e.components,t=(0,r.Z)(e,f);return(0,l.kt)("wrapper",(0,a.Z)({},v,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"For plugins which make use of ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/CLI%20scripts"},"CLI scripts"),", the convention is that these are placed into the ",(0,l.kt)("inlineCode",{parentName:"p"},"cli")," folder to make their purpose clear, and easy to find."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"All CLI scripts ",(0,l.kt)("strong",{parentName:"p"},"must")," declare themselves as being a CLI script by defining the ",(0,l.kt)("inlineCode",{parentName:"p"},"CLI_SCRIPT")," constant to true before including ",(0,l.kt)("inlineCode",{parentName:"p"},"config.php"),"."))))}k.isMDXComponent=!0;var y=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/cli/",summary:"CLI scripts",exampleFilepath:"/cli/example.php",examplePurpose:"Example CLI script",defaultDescription:k,defaultExample:"define('CLI_SCRIPT', true);\n\nrequire_once(__DIR__ . '/../../config.php');\nrequire_once(\"{$CFG->libdir}/clilib.php\");\n\n// Your CLI features go here.\n"},e))},N=["components"],w={toc:[]};function b(e){var n=e.components,t=(0,r.Z)(e,N);return(0,l.kt)("wrapper",(0,a.Z)({},w,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"If your plugin includes a changelog in its root directory, this will be used to automatically pre-fill the release notes field when uploading new versions of your plugin to the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Plugins%20directory"},"Plugins directory"),". This file can be in any of the following locations:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CHANGES.md"),": as a markdown file; or"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CHANGES.txt"),": as a text file; or"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CHANGES.html"),": as an HTML file; or"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CHANGES"),": as a text file.")))}b.isMDXComponent=!0;var x=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/CHANGES",filetype:"php",summary:"Plugin changelog",recommended:!0,defaultDescription:b},e))},M=["components"],E={toc:[]};function D(e){var n=e.components,t=(0,r.Z)(e,M);return(0,l.kt)("wrapper",(0,a.Z)({},E,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Moodle supports, and recommends, the use of autoloaded PHP classes."),(0,l.kt)("p",null,"By placing files within the ",(0,l.kt)("inlineCode",{parentName:"p"},"classes")," directory or appropriate sub-directories, and with the correct PHP Namespace, and class name, Moodle is able to autoload classes without the need to manually require, or include them."),(0,l.kt)("p",null,"Details on these rules and conventions are available in the following documentation:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/general/development/policies/codingstyle#namespaces"},"Coding style - namespace conventions")),(0,l.kt)("li",{parentName:"ul"},"",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Automatic%20class%20loading"},"Automatic class loading"),"")))}D.isMDXComponent=!0;var P=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/classes/",summary:"Autoloaded classes",defaultDescription:D},e))},_=["components"],T={toc:[]};function L(e){var n=e.components,t=(0,r.Z)(e,_);return(0,l.kt)("wrapper",(0,a.Z)({},T,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/access.php")," file contains the ",(0,l.kt)("strong",{parentName:"p"},"initial")," configuration for a plugin's access control rules."),(0,l.kt)("p",null,"Access control is handled in Moodle by the use of Roles, and Capabilities. You can read more about these in the ",(0,l.kt)("a",{parentName:"p",href:"/devdocs/docs/apis/subsystems/access"},"Access API")," documentation."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Changing initial configuration")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"If you make changes to the initial configuration of ",(0,l.kt)("em",{parentName:"p"},"existing")," access control rules, these will only take effect for ",(0,l.kt)("em",{parentName:"p"},"new installations of your plugin"),". Any existing installation ",(0,l.kt)("strong",{parentName:"p"},"will not")," be updated with the latest configuraiton."),(0,l.kt)("p",{parentName:"div"},"Updating existing capability configuration for an installed site is not recommended as it may have already been modified by an administrator."))))}L.isMDXComponent=!0;var A=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:L,defaultExample:"$capabilities = [\n    // Ability to use the plugin.\n    'plugintype/pluginname:useplugininstance' => [\n        'riskbitmask' => RISK_XSS,\n        'captype' => 'write',\n        'contextlevel' => CONTEXT_COURSE,\n        'archetypes' => [\n            'manager' => CAP_ALLOW,\n            'editingteacher' => CAP_ALLOW,\n        ],\n    ],\n];\n",filepath:"/db/access.php",summary:"Plugin capabilities",examplePurpose:"Plugin capabilities"},e))},C=["components"],Z={toc:[]};function I(e){var n=e.components,t=(0,r.Z)(e,C);return(0,l.kt)("wrapper",(0,a.Z)({},Z,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Moodle supports a feature known as ",(0,l.kt)("em",{parentName:"p"}," ",(0,l.kt)("a",{parentName:"em",href:"https://docs.moodle.org/dev/Events_API#Event_observers"},"Event observers")," ")," to allow components to make changes when certain events take place."),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/events.php")," file allows you define any event subscriptions that your plugin needs to listen for."),(0,l.kt)("p",null,"Event subscriptions are a convenient way to observe events generated elsewhere in Moodle."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Communication between components")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"You ",(0,l.kt)("em",{parentName:"p"},"should not")," use event subscriptions to subscribe to events belonging to other plugins, without defining a dependency upon that plugin."),(0,l.kt)("p",{parentName:"div"},"See the ",(0,l.kt)("a",{parentName:"p",href:"/general/development/policies/component-communication#event-observers"},"Component communication principles")," documentation for a description of some of the risks of doing so."))))}I.isMDXComponent=!0;var S=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,defaultDescription:I,defaultExample:"$observers = [\n    [\n        'eventname' => '\\core\\event\\course_module_created',\n        'callback'  => '\\plugintype_pluginname\\event\\observer\\course_module_created::store',\n        'priority'  => 1000,\n    ],\n];\n",filepath:"/db/events.php",summary:"Event observer definitions",examplePurpose:"Event observer definitions"},e))},R=["components"],X={toc:[]};function $(e){var n=e.components,t=(0,r.Z)(e,R);return(0,l.kt)("wrapper",(0,a.Z)({},X,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/install.php")," file allows you define a post-installation hook, which is called immediately after the initial creation of your database schema."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"This file is not used at all after the ",(0,l.kt)("em",{parentName:"p"},"initial")," installation of your plugin."),(0,l.kt)("p",{parentName:"div"},"It is ",(0,l.kt)("em",{parentName:"p"},"not called")," during any upgrade."))))}$.isMDXComponent=!0;var H=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:$,filepath:"/CHANGES",filetype:"php",summary:"Post-installation hook"},e))},U=["components"],z={toc:[]};function B(e){var n=e.components,t=(0,r.Z)(e,U);return(0,l.kt)("wrapper",(0,a.Z)({},z,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"install.xml")," file is used to define any database tables, fields, indexes, and keys, which should be created for a plugin during its initial insatllation."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"When creating or updating the ",(0,l.kt)("inlineCode",{parentName:"p"},"install.xml")," you ",(0,l.kt)("strong",{parentName:"p"},"must")," use the built-in ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/XMLDB%20Documentation"},"XMLDB editor")," within Moodle."))))}B.isMDXComponent=!0;var O=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/db/install.xml",summary:"Database schema",examplePurpose:"Database schema",defaultDescription:B},e))},F=["components"],G={toc:[]};function Y(e){var n=e.components,t=(0,r.Z)(e,F);return(0,l.kt)("wrapper",(0,a.Z)({},G,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/messages.php")," file allows you to declare the messages that your plugin sends."),(0,l.kt)("p",null,"See the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Message%20API"},"Message API")," documentation for further information."))}Y.isMDXComponent=!0;var q=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,defaultExample:"\n$messageproviders = [\n    'things' => [\n        'defaults' => [\n            'airnotifier' => MESSAGE_PERMITTED + MESSAGE_DEFAULT_ENABLED,\n        ],\n    ],\n];\n",defaultDescription:Y,filepath:"/db/messages.php",summary:"Message provider configuration",examplePurpose:"Message provider configuration"},e))},W=["components"],j={toc:[]};function V(e){var n=e.components,t=(0,r.Z)(e,W);return(0,l.kt)("wrapper",(0,a.Z)({},j,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The Moodle Mobile remote add-on is the mobile app version of the plugin that will be loaded when a user accesses the plugin on the app."),(0,l.kt)("p",null,"A plugin can include several Mobile add-ons. Each add-on must indicate a unique name."),(0,l.kt)("p",null,"See the ",(0,l.kt)("a",{parentName:"p",href:"../../guides/moodleapp/development/plugins-development-guide"},"Moodle App Plugins Development Guide")," for more information on configuring your plugin for the Moodle MobileApp."))}V.isMDXComponent=!0;var J=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,defaultDescription:V,filepath:"/db/mobile.php",summary:"MoodleMobile version of the plugin"},e))},K=["components"],Q={toc:[]};function ee(e){var n=e.components,t=(0,r.Z)(e,K);return(0,l.kt)("wrapper",(0,a.Z)({},Q,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Details of classes that have been renamed to fit in with autoloading. See ",(0,l.kt)("a",{parentName:"p",href:"https://moodle.org/mod/forum/discuss.php?d=262403"},"forum discussion")," for details."))}ee.isMDXComponent=!0;var ne=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringPurge:!0,defaultExample:"\ndefined('MOODLE_INTERNAL') || die;\n\n$renamedclasses = [\n    'old_class_name' => 'fully_qualified\\\\new\\\\name',\n\n    // Examples:\n    'assign_header' => 'mod_assign\\\\output\\\\header',\n    '\\assign_header' => 'mod_assign\\\\output\\\\header',\n    '\\assign' => 'mod_assign\\\\assignment',\n\n    // Incorrect:\n    // The new class name should _not_ have a leading \\.\n    'assign_header' => '\\\\mod_assign\\\\output\\\\header',\n];\n",defaultDescription:ee,filepath:"/db/renamedclasses.php",summary:"Renamed classes",examplePurpose:"Renamed classes"},e))},te=["components"],ae={toc:[]};function ie(e){var n=e.components,t=(0,r.Z)(e,te);return(0,l.kt)("wrapper",(0,a.Z)({},ae,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/services.php")," file is used to describe the external functions available for use in web services. This includes\nweb service functions defined for javascript, and for the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Moodle%20Mobile%20App"},"Moodle Mobile App"),"."),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Web services should be named following the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Web_service_API_functions#Naming_convention"},"naming convention for web services"),"."))),(0,l.kt)("p",null,"For further information on external functions and web services, see:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Adding%20a%20web%20service%20to%20a%20plugin"},"Adding a web service to a plugin"),""),(0,l.kt)("li",{parentName:"ul"},"",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Web%20services%20API"},"Web services API"),""),(0,l.kt)("li",{parentName:"ul"},"",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/External%20functions%20API"},"External functions API"),"")))}ie.isMDXComponent=!0;var oe=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,recommended:!0,filepath:"/db/services.php",summary:"Web service function declarations",examplePurpose:"Web service function declarations",defaultExample:"\n$functions = [\n    'plugintype_pluginname_create_things' => [\n        'classname' => 'plugintype_pluginname\\external\\create_things',\n        'methodname' => 'execute',\n        'description' => 'Create a new thing',\n        'type' => 'write',\n        'capabilities' => 'plugintype/pluginname:create_things',\n        'ajax' => true,\n        'services' => [\n            MOODLE_OFFICIAL_MOBILE_SERVICE,\n        ],\n    ],\n];\n",defaultDescription:ie},e))},re=["components"],le={toc:[]};function se(e){var n=e.components,t=(0,r.Z)(e,re);return(0,l.kt)("wrapper",(0,a.Z)({},le,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/uninstall.php")," file allows you define a pre-uninstallation hook, which is called immediately before all table and data from your plugin are removed."))}se.isMDXComponent=!0;var pe=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:se,filepath:"/db/uninstall.php",filetype:"php",summary:"Pre-uninstallation hook"},e))},de=["components"],ue={toc:[]};function ce(e){var n=e.components,t=(0,r.Z)(e,de);return(0,l.kt)("wrapper",(0,a.Z)({},ue,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/upgrade.php")," file contains upgrade steps, including database schema changes, changes to settings, and other steps which must be performed during upgrade."),(0,l.kt)("p",null,"See the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Upgrade%20API"},"Upgrade API")," documentation for further information."),(0,l.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Generating Database Schema changes")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"When making changes to the database schema you ",(0,l.kt)("strong",{parentName:"p"},"must")," use the build-in ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/XMLDB%20Documentation"},"XMDLB editor")," within\nMoodle. This can be used to generate php upgrade steps."),(0,l.kt)("p",{parentName:"div"},"The ",(0,l.kt)("a",{parentName:"p",href:"#dbinstallxml"},"install.xml")," schema must match the schema generated by the upgrade at all times."))),(0,l.kt)("p",null,"To create an upgrade step you must:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Use the ",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/XMLDB_editor"},"XMLDB editor")," to create the definition of the new fields"),(0,l.kt)("li",{parentName:"ol"},"Update the ",(0,l.kt)("inlineCode",{parentName:"li"},"install.xml")," from the XMLDB editor"),(0,l.kt)("li",{parentName:"ol"},"Generate the PHP upgrade steps from within the XMLDB Editor"),(0,l.kt)("li",{parentName:"ol"},"Update the version number in your ",(0,l.kt)("inlineCode",{parentName:"li"},"version.php"))),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"In many cases you will be able to combine multiple upgrade steps into a single version change."))),(0,l.kt)("p",null,"When a version number increment is detected during an upgrade, the ",(0,l.kt)("inlineCode",{parentName:"p"},"xmldb_[pluginname]_upgrade")," function is called with the old version number as the first argument."),(0,l.kt)("p",null,"See the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Upgrade%20API"},"Upgrade API")," documentation for more information on the upgrade process."))}ce.isMDXComponent=!0;var me=function(e){return i.createElement(o.nR,(0,a.Z)({recommended:!0,defaultDescription:ce,defaultExample:"\nfunction xmldb_certificate_upgrade($oldversion = 0) {\n    if ($oldversion < 2012091800) {\n        // Add new fields to certificate table.\n        $table = new xmldb_table('certificate');\n        $field = new xmldb_field('showcode');\n        $field->set_attributes(XMLDB_TYPE_INTEGER, '1', XMLDB_UNSIGNED, XMLDB_NOTNULL, null, '0', 'savecert');\n        if (!$dbman->field_exists($table, $field)) {\n            $dbman->add_field($table, $field);\n        }\n        // Add new fields to certificate_issues table.\n        $table = new xmldb_table('certificate_issues');\n        $field = new xmldb_field('code');\n        $field->set_attributes(XMLDB_TYPE_CHAR, '50', null, null, null, null, 'certificateid');\n        if (!$dbman->field_exists($table, $field)) {\n            $dbman->add_field($table, $field);\n        }\n\n        // Certificate savepoint reached.\n        upgrade_mod_savepoint(true, 2012091800, 'certificate');\n    }\n}",filepath:"/db/upgrade.php",summary:"Upgrade steps",examplePurpose:"Upgrade steps"},e))},he=["components"],ge={toc:[]};function fe(e){var n=e.components,t=(0,r.Z)(e,he);return(0,l.kt)("wrapper",(0,a.Z)({},ge,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"A plugin can declare its own environment requirements, in addition to those declared by Moodle core. These may includes features such as PHP extension requirements, version requirements, and similar items."),(0,l.kt)("p",null,"Further information on this file and its format can be found in the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Environment%20checking"},"Environment checking")," documentation."))}fe.isMDXComponent=!0;var ve=function(e){return i.createElement(o.nR,(0,a.Z)({showFileHeader:!1,showLicense:!1,refreshedDuringUpgrade:!0,filepath:"/environment.xml",filetype:"xml",summary:"Plugin-specific environment requirements",defaultDescription:fe,defaultExample:'\n<?xml version="1.0" encoding="UTF-8" ?>\n<COMPATIBILITY_MATRIX>\n  <PLUGIN name="plugintype_pluginname">\n    <PHP_EXTENSIONS>\n      <PHP_EXTENSION name="soap" level="required">\n      </PHP_EXTENSION>\n    </PHP_EXTENSIONS>\n  </PLUGIN>\n</COMPATIBILITY_MATRIX>'},e))},ke=["components"],ye={toc:[]};function Ne(e){var n=e.components,t=(0,r.Z)(e,ke);return(0,l.kt)("wrapper",(0,a.Z)({},ye,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Each plugin must define a set of language strings with, at a minimum, an English translation. These are specified in the plugin's ",(0,l.kt)("inlineCode",{parentName:"p"},"lang/en")," directory in a file named after the plugin. For example the LDAP authentication plugin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"// Plugin type: `auth`\n// Plugin name: `ldap`\n// Frankenstyle plugin name: `auth_ldap`\n// Plugin location: `auth/ldap`\n// Language string location: `auth/ldap/lang/en/auth_ldap.php`\n")),(0,l.kt)("p",null,"Every plugin ",(0,l.kt)("em",{parentName:"p"},"must")," define the name of the plugin, or its ",(0,l.kt)("inlineCode",{parentName:"p"},"pluginname"),"."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Activity modules are different")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Activity modules do not use the ",(0,l.kt)("strong",{parentName:"p"},"frankenstyle")," name as a filename, they use the plugin name. For example the forum activity plugin:"),(0,l.kt)("pre",{parentName:"div"},(0,l.kt)("code",{parentName:"pre",className:"language-php"},"// Plugin type: `mod`\n// Plugin name: `forum`\n// Frankenstyle plugin name: `mod_forum`\n// Plugin location: `mod/forum`\n// Language string location: `mod/forum/lang/en/forum.php`\n")))),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"get_string")," API can be used to translate a string identifier back into a translated string."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"get_string('pluginname', '[plugintype]_[pluginname]');\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"See the ",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/String%20API#Adding_language_file_to_plugin"},"String API")," documentation for more information on language files.")))}Ne.isMDXComponent=!0;var we=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/lang/en/plugintype_pluginname.php",refreshedDuringPurge:!0,required:!0,summary:"Language files",examplePurpose:"Languages configuration",defaultDescription:Ne,defaultExample:"$string['pluginname'] = 'The name of my plugin will go here';"},e))},be=["components"],xe={toc:[]};function Me(e){var n=e.components,t=(0,r.Z)(e,be);return(0,l.kt)("wrapper",(0,a.Z)({},xe,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"lib.php")," file is a legacy file which acts as a bridge between Moodle core, and the plugin. In recent plugins it is should only used to define callbacks and related functionality which currenltly is not supported as an autoloadable class."),(0,l.kt)("p",null,"All functions defined in this file ",(0,l.kt)("strong",{parentName:"p"},"must")," meet the requirements set out in the relevant section of the ",(0,l.kt)("a",{parentName:"p",href:"/general/development/policies/codingstyle#Functions-and-Methods"},"Coding style"),"."),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Performance impact")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Moodle core often loads all the ",(0,l.kt)("tt",null,"lib.php")," files of a given plugin types. For performance reasons, it is strongly recommended to keep this file as small as possible and have just required code implemented in it. All the plugin's internal logic should be implemented in the auto-loaded classes."))))}Me.isMDXComponent=!0;var Ee=function(e){return i.createElement(o.nR,(0,a.Z)({legacy:!0,required:!1,filepath:"/lib.php",summary:"Global plugin functions",examplePurpose:"Plugin functions",defaultDescription:Me},e))},De=["components"],Pe={toc:[]};function _e(e){var n=e.components,t=(0,r.Z)(e,De);return(0,l.kt)("wrapper",(0,a.Z)({},Pe,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Legacy feature")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"The use of this file is no longer recommended, and new uses of it will not be permitted in core code."))),(0,l.kt)("p",null,"Rather than creating global functions in a global namespace in a ",(0,l.kt)("tt",null,"locallib.php")," file, you should use autoloaded classes which are located in the ",(0,l.kt)("tt",null,"classes/")," directory."),(0,l.kt)("p",null,"Where this file is in use, all functions ",(0,l.kt)("strong",{parentName:"p"},"must")," meet the requirements set out in the relevant section of the ",(0,l.kt)("a",{parentName:"p",href:"/general/development/policies/codingstyle#Functions-and-Methods"},"Coding style")),(0,l.kt)("p",null,"Existing functions which have been incorrectly named ",(0,l.kt)("strong",{parentName:"p"},"will not")," be accepted as an example of an existing convention. Existing functions which are incorrectly named ",(0,l.kt)("strong",{parentName:"p"},"should")," be converted to use a namespaced class."))}_e.isMDXComponent=!0;var Te=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:_e,filepath:"/locallib.php",legacy:!0,required:!1,summary:"Global support functions"},e))},Le=["components"],Ae={toc:[]};function Ce(e){var n=e.components,t=(0,r.Z)(e,Le);return(0,l.kt)("wrapper",(0,a.Z)({},Ae,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Plugins can provide icons in several formats, and most plugin types require that a default icon be provided."),(0,l.kt)("p",null,"Where a browser supports it, the ",(0,l.kt)("inlineCode",{parentName:"p"},"svg")," format is used, falling back to ",(0,l.kt)("inlineCode",{parentName:"p"},"png")," formats when an SVG is unavailable."),(0,l.kt)("p",null,"Full details of the correct naming, sizing, and design guidelines for icons in Moodle can be found in the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Moodle%20icons"},"Moodle icons")," documentation."))}Ce.isMDXComponent=!0;var Ze=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:Ce,refreshedDuringPurge:!0,filepath:"/pix/",summary:"Plugins icons"},e))},Ie=["components"],Se={toc:[]};function Re(e){var n=e.components,t=(0,r.Z)(e,Ie);return(0,l.kt)("wrapper",(0,a.Z)({},Se,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"We recommend that you include any additional information for your plugin in a project readme file. Ideally this should act as an offline version of all information in your plugin's page in the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Plugins%20directory"},"Plugins directory"),"."),(0,l.kt)("p",null,"We recommend creating your readme file in either a ",(0,l.kt)("inlineCode",{parentName:"p"},"README.md"),", or ",(0,l.kt)("inlineCode",{parentName:"p"},"README.txt")," format."))}Re.isMDXComponent=!0;var Xe=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/README",recommended:!0,defaultDescription:Re,summary:"Plugin Information for Administrators"},e))},$e=["components"],He={toc:[]};function Ue(e){var n=e.components,t=(0,r.Z)(e,$e);return(0,l.kt)("wrapper",(0,a.Z)({},He,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"When importing a third-party library into your plugin, it is advisable to create a ",(0,l.kt)("inlineCode",{parentName:"p"},"readme_moodle.txt")," file detailing relevant information, including:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Download URLs"),(0,l.kt)("li",{parentName:"ul"},"Build instructions")))}Ue.isMDXComponent=!0;var ze=function(e){return i.createElement(o.nR,(0,a.Z)({recommended:!0,filepath:"/*/readme_moodle.txt",defaultDescription:Ue,summary:"Third-party library import instructions"},e))},Be=["components"],Oe={toc:[]};function Fe(e){var n=e.components,t=(0,r.Z)(e,Be);return(0,l.kt)("wrapper",(0,a.Z)({},Oe,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"You can define settings for your plugin that the administrator can configure by creating a ",(0,l.kt)("inlineCode",{parentName:"p"},"settings.php")," file in the root of your plugins' directory."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Settings must named in the following format:"),(0,l.kt)("pre",{parentName:"div"},(0,l.kt)("code",{parentName:"pre"},"plugintype_pluginname/settingname\n")),(0,l.kt)("p",{parentName:"div"},"By following the correct naming, all settings will automatically be stored in the ",(0,l.kt)("inlineCode",{parentName:"p"},"config_plugins")," database table."))),(0,l.kt)("p",null,"Full details on how to create settings are available in the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Admin%20settings"},"Admin settings")," documentation."))}Fe.isMDXComponent=!0;var Ge=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:Fe,filepath:"/settings.php",summary:"Plugin settings",examplePurpose:"Plugin settings"},e))},Ye=["components"],qe={toc:[]};function We(e){var n=e.components,t=(0,r.Z)(e,Ye);return(0,l.kt)("wrapper",(0,a.Z)({},qe,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Plugins may define a '/styles.css' to provide plugin-specific styling. See the following for further documentation:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Plugin%20contribution%20checklist#CSS%20styles"},"CSS styles"),""),(0,l.kt)("li",{parentName:"ul"},"",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/CSS%20Coding%20Style"},"CSS Coding Style"),"")),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Avoid custom styles where possible")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Rather than writing custom CSS for your plugin, where possible apply Bootstrap classes to the DOM elements in your output. These will be easier to maintain and will adopt most colour, branding, and other customisations applied to a theme."))))}We.isMDXComponent=!0;var je=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringPurge:!0,defaultDescription:We,filepath:"/styles.css",summary:"CSS style sheet for your plugin"},e))},Ve=["components"],Je={toc:[]};function Ke(e){var n=e.components,t=(0,r.Z)(e,Ve);return(0,l.kt)("wrapper",(0,a.Z)({},Je,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Details of all third-party libraries should be declared in the ",(0,l.kt)("inlineCode",{parentName:"p"},"thirdpartylibs.xml")," file."),(0,l.kt)("p",null,"This information is used to generate ignore file configuration for linting tools. For Moodle core it is also used to generate library information as part of release notes and credits."),(0,l.kt)("p",null,"Within the XML the ",(0,l.kt)("inlineCode",{parentName:"p"},"location")," is a file, or directory, relative to your plugin's root."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Licensing")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"The license of any third-party code included in your plugin, and within the ",(0,l.kt)("inlineCode",{parentName:"p"},"thirdpartylibs.xml")," file ",(0,l.kt)("strong",{parentName:"p"},"must")," be ",(0,l.kt)("a",{parentName:"p",href:"http://www.gnu.org/licenses/license-list.html#GPLCompatibleLicenses"},"compatible with the GNU GPLv3"),"."))),(0,l.kt)("p",null,"See the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Third_Party_Libraries"},"Third Party Libraries")," documentation for further information."))}Ke.isMDXComponent=!0;var Qe=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:Ke,defaultExample:'<?xml version="1.0"?>\n<libraries>\n    <library>\n        <location>javascript/html5shiv.js</location>\n        <name>Html5Shiv</name>\n        <version>3.6.2</version>\n        <license>Apache</license>\n        <licenseversion>2.0</licenseversion>\n    </library>\n    <library>\n        <location>vendor/guzzle/guzzle/</location>\n        <name>guzzle</name>\n        <version>v3.9.3</version>\n        <license>MIT</license>\n        <licenseversion></licenseversion>\n    </library>\n</libraries>',filepath:"/thirdpartylibs.xml",filetype:"xml",summary:"Details of third-party libraries includedin the plugin",showLicense:!1,showFileHeader:!1},e))},en=["components"],nn={toc:[]};function tn(e){var n=e.components,t=(0,r.Z)(e,en);return(0,l.kt)("wrapper",(0,a.Z)({},nn,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The version.php contains metadata about the plugin."),(0,l.kt)("p",null,"It is used during the installation and upgrade of the plugin."),(0,l.kt)("p",null,"This file contains metadata used to describe the plugin, and includes information such as:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"the version number"),(0,l.kt)("li",{parentName:"ul"},"a list of dependencies"),(0,l.kt)("li",{parentName:"ul"},"the minimum Moodle version required"),(0,l.kt)("li",{parentName:"ul"},"maturity of the plugin")))}tn.isMDXComponent=!0;var an=function(e){return i.createElement(o.nR,(0,a.Z)({required:!0,filepath:"/version.php",filetype:"php",summary:"Version metadata",examplePurpose:"Version metadata",defaultDescription:tn,defaultExample:"defined('MOODLE_INTERNAL') || die();\n\n$plugin->version = TODO;\n$plugin->requires = TODO;\n$plugin->supported = TODO;   // Available as of Moodle 3.9.0 or later.\n$plugin->incompatible = TODO;   // Available as of Moodle 3.9.0 or later.\n$plugin->component = 'TODO_FRANKENSTYLE';\n$plugin->maturity = MATURITY_STABLE;\n$plugin->release = 'TODO';\n\n$plugin->dependencies = [\n    'mod_forum' => 2022042100,\n    'mod_data' => 2022042100\n];\n"},e))},on=["components"],rn={toc:[]};function ln(e){var n=e.components,t=(0,r.Z)(e,on);return(0,l.kt)("wrapper",(0,a.Z)({},rn,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"In older versions of Moodle, JavaScript was written in the YUI format. This is being phased out in favour of ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Javascript%20Modules"},"Javascript Modules"),", although some older uses still remain in Moodle core."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/YUI/Modules"},"YUI/Modules"),""),(0,l.kt)("li",{parentName:"ul"},"",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/YUI"},"YUI"),"")),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"New YUI code will not be accepted into Moodle core, except for new plugins for the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Atto"},"Atto editor"),"."))))}ln.isMDXComponent=!0;var sn=function(e){return i.createElement(o.nR,(0,a.Z)({legacy:!0,refreshedDuringPurge:!0,defaultDescription:ln,filepath:"/yui/",examplePurpose:"YUI JavaScript Modules",summary:"YUI JavaScript Modules"},e))}},2798:function(e){e.exports={siteHome:"https://moodle.academy/",courses:{setup:{id:29,name:"Set up your Moodle Development Environment",summary:"Learn about the Moodle developer community and setting up a development environment",description:"This course is designed for PHP developers who want to start developing Moodle plugins. You will learn about the Moodle developer community and set up a Moodle development environment. This is the first course in the Developer Pathway. Subsequent courses in the the Developer Pathway will build on the knowledge gained in this course.",tags:["development","basics","setup"],archived:!1,series:[]},securityEssentials:{id:53,name:"Moodle Access and Security Essentials",summary:"A short course looking at access control and security aspects of plugins.",description:"In this course we look at access control and security aspects of a plugin. Through a set of tutorials, you will learn how to control access to your plugin using Moodle\u2019s Access API. You will learn how to define capabilities in your plugin and how to determine if the user has the permission to access a page. This course also covers common security threats that developers need to be aware of.\n\nThis is the fourth course in the Moodle Developer Basics program.",tags:["development","basic","essentials","security","api"],archived:!1,series:["basics"]},outputEssentials:{id:49,name:"Web Output Essentials",summary:"Learn how to use Moodle's Page and Output APIs to display content in a local plugin.",description:"This course builds on the knowledge gained in the Moodle development environment course. In this course, we learn how to use Moodle's Page and Output APIs to display content in a local plugin. An introduction to localisation using language strings is also covered in this course. This is the second course in the Moodle developer pathway.",tags:["development","basics","essentials","output","api"],archived:!1,series:["basics"]},architecture:{id:51,name:"Moodle's Modular Architecture and APIs",summary:"Take a deeper look at Moodle's architecture, exploring common APIs including Navigations, Forms, Database, Upgrade, Strings, and Output.",description:"In this course we take a deeper look at Moodle's modular architecture and explore the use of common Moodle APIs. Some of the APIs covered in this course include: Navigation, Forms, Database access, Upgrade, Strings and Output APIs. Learners get hands-on practise on using these APIs in the form of developing a local plugin.\n\nThis is the third course in the Moodle Developer Basics program.",tags:["development","api","architecture"],archived:!1,series:["basics"]},pluginBasics:{id:10,name:"Moodle Plugin Development Basics",summary:"Learn about the essential concepts in Moodle's moduel architecture.",description:"This course teaches you essential concepts related to Moodle's modular architecture, enabling you to develop a simple demo plugin.\n\nPlease note, this course is being migrated to form a new program of short courses on Moodle Academy (called 'Moodle Developer Basics'), which will all be available at the end of April 2022. For now you may still complete the course on Learn Moodle, or you might like to start the Moodle Academy developer short courses that are being released over the coming weeks and will form this new beginner level program.",tags:["development","basics","essentials","api","plugins","architecture"],archived:!1,series:["basics"]}}}},7312:function(e,n,t){"use strict";t.d(n,{dn:function(){return v.Z},nR:function(){return f},vL:function(){return u},U6:function(){return s},E2:function(){return k.Z},mQ:function(){return y.Z},Zh:function(){return d}});t(6134);var a=t(7294),i=t(3380),o=t(6447),r=t(9960);function l(e,n,t){var o=function(e){return"number"==typeof e&&Number.isInteger(e)?e.toFixed(1):e}(n),l=a.createElement("span",null,function(e){if("since"===e)return"Since";if("deprecated"===e)return"Deprecated";throw new Error("Unknown <Since> type: '"+e+"'")}(e)," ",o),s=a.createElement(i.Z,{key:"chip-"+e+o,label:l,clickable:!!t});return t?a.createElement(r.Z,{to:"https://tracker.moodle.org/browse/"+t,key:"link-"+e+o},s):s}function s(e){var n,t,i,r,s,p,d,u,c,m=(t=(n=e).issueNumber,i=void 0===t?null:t,r=n.type,s=void 0===r?"since":r,p=n.versions,d=void 0===p?[]:p,u=n.version,(c=void 0===u?null:u)?l(s,c,i):d.map((function(e){return l(s,e,i)})));return a.createElement(o.Z,{direction:"row",justifyContent:"flex-end",spacing:2},m)}var p=t(6010);function d(e){return a.createElement("div",{className:(0,p.Z)(" alert alert--success margin-bottom--lg ")},a.createElement("span",{className:(0,p.Z)(" badge badge--success ")},"An example of correct behaviour"),e.children)}function u(e){return a.createElement("div",{className:(0,p.Z)(" alert alert--danger margin-bottom--lg ")},a.createElement("span",{className:(0,p.Z)(" badge badge--danger ")},"An example of incorrect behaviour"),e.children)}var c=t(3908),m=t(6886),h=t(7488),g=function(e,n,t){return void 0===t&&(t="info"),a.createElement(m.ZP,{item:!0,key:e},a.createElement(c.Z,{title:n},a.createElement(i.Z,{label:e,color:t})))};function f(e){var n=e.filepath,t=e.summary,i=function(e){var n=e.required,t=void 0!==n&&n,a=e.legacy,i=void 0!==a&&a,o=e.deprecated,r=void 0!==o&&o,l=e.refreshedDuringUpgrade,s=void 0!==l&&l,p=e.refreshedDuringPurge,d=void 0!==p&&p,u=[];return s&&u.push(g("Upgradable","Changes to this file or directory will be re-applied during a Moodle upgrade. If you make any changes to it, you can simply increment the version number and perform a Moodle upgrade.","info")),d&&u.push(g("Refreshed on cache purge","The contents of this file or directory are cached. To see your changes you can simply purge Moodle's caches and refresh the page.","info")),t&&u.push(g("Required","This file must be present","success")),i&&u.push(g("Legacy","Use of this file is being phased out. It is still supported for older installations but will be removed..","warning")),r&&u.push(g("Deprecated","Use of this file is deprecated and not recommended.It may still be provided for older versions of Moodle but is no longer used.","error")),u}(e),o=e.description?a.createElement(m.ZP,{item:!0,xs:12},e.description):null;return a.createElement(m.ZP,{container:!0,spacing:2},a.createElement(m.ZP,{item:!0,xs:6},a.createElement("h4",null,t)),a.createElement(m.ZP,{item:!0,xs:6},a.createElement(m.ZP,{container:!0,spacing:2,justifyContent:"flex-end"},i)),a.createElement(m.ZP,{item:!0,xs:12},a.createElement("h5",null,"File path:"," ",n)),o,function(e){var n=e.example,t=e.open,i=void 0!==t&&t;return n?a.createElement(m.ZP,{item:!0,xs:12},a.createElement(h.Z,{summary:a.createElement("summary",null,"View example"),open:i},n)):null}(e))}var v=t(8066),k=t(8215),y=t(9877)},6134:function(e,n,t){"use strict";t.d(n,{Z:function(){return d}});var a=t(7294),i=t(3123),o=t(9960),r=t(8698),l=t(2798),s=t.n(l),p=t(3908);function d(e){var n=e.courseName;if(!s().courses[n])throw Error("Unknown course "+n);var t=s().courses[n];return a.createElement(i.Z,{type:"info",icon:a.createElement(r.Z,{fontSize:"inherit"}),title:"Learn more on Moodle Academy"},"You can learn more about"," ",a.createElement("strong",null,e.subject)," ","from the"," ",a.createElement(p.Z,{title:t.summary},a.createElement(o.Z,{to:s().siteHome+"course/view.php?id="+t.id},t.name))," ","on Moodle Academy.")}},8989:function(e,n,t){"use strict";t.d(n,{W7:function(){return c}});var a,i=t(7294),o=t(8066),r=JSON.parse('{"plugintypes":{"antivirus":"lib/antivirus","availability":"availability/condition","qtype":"question/type","mod":"mod","auth":"auth","calendartype":"calendar/type","customfield":"customfield/field","enrol":"enrol","message":"message/output","block":"blocks","media":"media/player","filter":"filter","editor":"lib/editor","format":"course/format","dataformat":"dataformat","profilefield":"user/profile/field","report":"report","coursereport":"course/report","gradeexport":"grade/export","gradeimport":"grade/import","gradereport":"grade/report","gradingform":"grade/grading/form","mlbackend":"lib/mlbackend","mnetservice":"mnet/service","webservice":"webservice","repository":"repository","portfolio":"portfolio","search":"search/engine","qbank":"question/bank","qbehaviour":"question/behaviour","qformat":"question/format","plagiarism":"plagiarism","tool":"admin/tool","cachestore":"cache/stores","cachelock":"cache/locks","fileconverter":"files/converter","contenttype":"contentbank/contenttype","theme":"theme","local":"local","h5plib":"h5p/h5plib","paygw":"payment/gateway"},"subsystems":{"access":null,"admin":"admin","adminpresets":"admin/presets","analytics":"analytics","antivirus":"lib/antivirus","auth":"auth","availability":"availability","backup":"backup/util/ui","badges":"badges","block":"blocks","blog":"blog","bulkusers":null,"cache":"cache","calendar":"calendar","cohort":"cohort","comment":"comment","competency":"competency","completion":"completion","contentbank":"contentbank","countries":null,"course":"course","courseformat":"course/format","currencies":null,"customfield":"customfield","dbtransfer":null,"debug":null,"editor":"lib/editor","edufields":null,"enrol":"enrol","error":null,"favourites":"favourites","filepicker":null,"fileconverter":"files/converter","files":"files","filters":"filter","form":"lib/form","grades":"grade","grading":"grade/grading","group":"group","help":null,"hub":null,"h5p":"h5p","imscc":null,"install":null,"iso6392":null,"langconfig":null,"license":null,"mathslib":null,"media":"media","message":"message","mimetypes":null,"mnet":"mnet","my":"my","notes":"notes","pagetype":null,"payment":"payment","pix":null,"plagiarism":"plagiarism","plugin":null,"portfolio":"portfolio","privacy":"privacy","question":"question","rating":"rating","reportbuilder":"reportbuilder","repository":"repository","rss":"rss","role":"admin/roles","search":"search","table":"lib/table","tag":"tag","timezones":null,"user":"user","userkey":"lib/userkey","webservice":"webservice","xapi":"lib/xapi"}}'),l=function(e){return function(n){var t=n.plugintype,a=void 0===t?"plugintype":t,i=n.pluginname,o=void 0===i?"pluginname":i,r=n.filepath,l=void 0===r?null:r,s=function(e){return function(n){return e.plugintypes[n]?e.plugintypes[n]:"[path/to/"+n+"]"}}(e)(a);return""+(s+=o?"/"+o:"/[pluginname]")+l}},s=l(r),p=(s(r),function(e){if(!e.showFileHeader)return"";switch(null==e?void 0:e.filetype){case"xml":return"";case"js":case"javascript":return function(e){var n=e.plugintype,t=void 0===n?"plugintype":n,a=e.pluginname,i=void 0===a?"pluginname":a,o=e.examplePurpose,r=e.modulename;if(!o)throw Error("Purpose must be specified");if(!r)throw Error("AMD Module name must be specified");return["/**"," * "+o+" for the "+t+"_"+i+" plugin."," *"," * @module   "+t+"_"+i+"/"+r," * @copyright Year, You Name <your@email.address>"," * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */",""].join("\n")}(e);default:return function(e){var n=e.plugintype,t=void 0===n?"plugintype":n,a=e.pluginname,i=void 0===a?"pluginname":a,o=e.examplePurpose;if(!o)throw Error("Purpose must be specified");return["/**"," * "+o+" for the "+t+"_"+i+" plugin."," *"," * @package   "+t+"_"+i," * @copyright Year, You Name <your@email.address>"," * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */",""].join("\n")}(e)}}),d=function(e){return e.showLicense?(e.filetype,"// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n"):""},u=function(e){var n=e.filetype,t=void 0===n?"php":n;switch(t){case"js":case"javascript":return"javascript";case"xml":return"xml";case"php":case null:return"php";default:return t}},c=(a=r,function(e,n){var t,r=Object.assign({plugintype:"plugintype",showLicense:!0,showFileHeader:!0,filepath:null!=(t=e.exampleFilepath)?t:e.filepath},e),s=l(a),c=function(e,n){void 0===n&&(n=null);var t=[d(e),p(e),e.example?e.example:n||null].filter((function(e){return e})).map((function(e){return e.trim()})).join("\n\n");return[function(e){var n=e.filetype;switch(void 0===n?"php":n){case"js":case"javascript":case"xml":return null;default:return"<?php"}}(e),t].filter((function(e){return e})).join("\n")}(r,n);return i.createElement(o.Z,{title:s(r),language:u(r)},c)})},49:function(e,n,t){"use strict";t.r(n),t.d(n,{assets:function(){return u},contentTitle:function(){return p},default:function(){return v},frontMatter:function(){return s},metadata:function(){return d},modifyNavigationExample:function(){return h},settingsNavigationExample:function(){return m},siteWideSettingsExample:function(){return g},toc:function(){return c}});var a=t(7462),i=t(3366),o=(t(7294),t(3905)),r=(t(8989),t(9742)),l=["components"],s={title:"Local plugins",tags:["Plugins"]},p=void 0,d={unversionedId:"apis/plugintypes/local/index",id:"apis/plugintypes/local/index",title:"Local plugins",description:"The recommended way to add new functionality to Moodle is to create a new standard plugin (for example, activity, block, authentication, enrol). The local plugin-type is mostly suitable for things that do not fit into these standard plugin types.",source:"@site/docs/apis/plugintypes/local/index.mdx",sourceDirName:"apis/plugintypes/local",slug:"/apis/plugintypes/local/",permalink:"/devdocs/docs/apis/plugintypes/local/",editUrl:"https://github.com/moodle/devdocs/edit/main/docs/apis/plugintypes/local/index.mdx",tags:[{label:"Plugins",permalink:"/devdocs/docs/tags/plugins"}],version:"current",lastUpdatedBy:"Sara Arjona",lastUpdatedAt:1651577570,formattedLastUpdatedAt:"03/05/2022",frontMatter:{title:"Local plugins",tags:["Plugins"]},sidebar:"docs",previous:{title:"Antivirus plugins",permalink:"/devdocs/docs/apis/plugintypes/antivirus/"},next:{title:"Activity modules",permalink:"/devdocs/docs/apis/plugintypes/mod/"}},u={},c=[{value:"List of differences from normal plugins:",id:"list-of-differences-from-normal-plugins",level:2},{value:"File structure",id:"file-structure",level:2},{value:"Examples",id:"examples",level:2},{value:"Adding an element to the settings menu",id:"adding-an-element-to-the-settings-menu",level:3},{value:"Removing the &quot;Site Home&quot; link from the navigation menu",id:"removing-the-site-home-link-from-the-navigation-menu",level:3},{value:"Adding Site Wide Settings For Your Local Plugin",id:"adding-site-wide-settings-for-your-local-plugin",level:3}],m="\nfunction local_[pluginname]_extend_settings_navigation($settingsnav, $context) {\n    global $CFG, $PAGE;\n\n    // Only add this settings item on non-site course pages.\n    if (!$PAGE->course or $PAGE->course->id == 1) {\n        return;\n    }\n\n    // Only let users with the appropriate capability see this settings item.\n    if (!has_capability('moodle/backup:backupcourse', context_course::instance($PAGE->course->id))) {\n        return;\n    }\n\n    if ($settingnode = $settingsnav->find('courseadmin', navigation_node::TYPE_COURSE)) {\n        $strfoo = get_string('foo', 'local_[pluginname]');\n        $url = new moodle_url('/local/[pluginname]/foo.php', array('id' => $PAGE->course->id));\n        $foonode = navigation_node::create(\n            $strfoo,\n            $url,\n            navigation_node::NODETYPE_LEAF,\n            '[pluginname]',\n            '[pluginname]',\n            new pix_icon('t/addcontact', $strfoo)\n        );\n        if ($PAGE->url->compare($url, URL_MATCH_BASE)) {\n            $foonode->make_active();\n        }\n        $settingnode->add_node($foonode);\n    }\n}\n",h="\nfunction local_[pluginname]_extend_navigation(global_navigation $navigation) {\n    if ($home = $navigation->find('home', global_navigation::TYPE_SETTING)) {\n        $home->remove();\n    }\n}\n",g="\n// Ensure the configurations for this site are set\nif ($hassiteconfig) {\n\n    // Create the new settings page\n    // - in a local plugin this is not defined as standard, so normal $settings->methods will throw an error as\n    // $settings will be null\n    $settings = new admin_settingpage('local_[pluginname]', 'Your Settings Page Title');\n\n    // Create\n    $ADMIN->add('localplugins', $settings);\n\n    // Add a setting field to the settings for this page\n    $settings->add(new admin_setting_configtext(\n        // This is the reference you will use to your configuration\n        'local_[pluginname]/apikey',\n\n        // This is the friendly title for the config, which will be displayed\n        'External API: Key',\n\n        // This is helper text for this config field\n        'This is the key used to access the External API',\n\n        // This is the default value\n        'No Key Defined',\n\n        // This is the type of Parameter this config is\n        PARAM_TEXT\n    ));\n}\n",f={toc:c,settingsNavigationExample:m,modifyNavigationExample:h,siteWideSettingsExample:g};function v(e){var n=e.components,t=(0,i.Z)(e,l);return(0,o.kt)("wrapper",(0,a.Z)({},f,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The recommended way to add new functionality to Moodle is to create a new standard plugin (for example, activity, block, authentication, enrol). The ",(0,o.kt)("inlineCode",{parentName:"p"},"local")," plugin-type is mostly suitable for things that do not fit into these standard plugin types."),(0,o.kt)("p",null,"Local plugins are used in cases when no standard plugin is suitable. Examples of these situations include:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"event consumers communicating with external systems"),(0,o.kt)("li",{parentName:"ul"},"custom definitions of web services and external functions"),(0,o.kt)("li",{parentName:"ul"},"applications that extend moodle at the system level (for example hub server, amos server)"),(0,o.kt)("li",{parentName:"ul"},"custom admin settings"),(0,o.kt)("li",{parentName:"ul"},"extending the navigation block with custom menus"),(0,o.kt)("li",{parentName:"ul"},"new database tables used in core hacks (",(0,o.kt)("strong",{parentName:"li"},"strongly discouraged"),")"),(0,o.kt)("li",{parentName:"ul"},"new capability definitions used in core hacks (",(0,o.kt)("strong",{parentName:"li"},"strongly discouraged"),")")),(0,o.kt)("h2",{id:"list-of-differences-from-normal-plugins"},"List of differences from normal plugins:"),(0,o.kt)("p",null,"Local plugins have several important differences from the standard plugin types, including:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"they are always executed last during install, and upgrade. This is guaranteed by their order in ",(0,o.kt)("inlineCode",{parentName:"li"},"get_plugin_types()"),"."),(0,o.kt)("li",{parentName:"ul"},"they are ",(0,o.kt)("em",{parentName:"li"},"expected")," to use event handlers. Event subscriptions are intended for communication from core to plugins only, making local plugins the ideal candidate for them."),(0,o.kt)("li",{parentName:"ul"},"they can add admin settings to any settings page. They are loaded last when constructing admin tree to enable this."),(0,o.kt)("li",{parentName:"ul"},"they ",(0,o.kt)("em",{parentName:"li"},"do not need")," to have any UI. Other plugin types are usually visible somewhere within the interface.")),(0,o.kt)("h2",{id:"file-structure"},"File structure"),(0,o.kt)("p",null,"Local plugins support the ",(0,o.kt)("a",{parentName:"p",href:"../commonfiles"},"standard plugin files")," supported by other plugin types."),(0,o.kt)("h2",{id:"examples"},"Examples"),(0,o.kt)("p",null,"The following examples show some ways in which you can use a local plugin."),(0,o.kt)("h3",{id:"adding-an-element-to-the-settings-menu"},"Adding an element to the settings menu"),(0,o.kt)("p",null,"A local plugin can extend or modify the settings navigation by defining a function named ",(0,o.kt)("inlineCode",{parentName:"p"},"local_[pluginname]_extend_settings_navigation")," in its ",(0,o.kt)("inlineCode",{parentName:"p"},"lib.php"),". This is called when Moodle builds the settings block. For example:"),(0,o.kt)(r.Gf,{plugintype:"local",pluginname:"[pluginname]",example:m,description:!1,open:!0,mdxType:"Lib"}),(0,o.kt)("h3",{id:"removing-the-site-home-link-from-the-navigation-menu"},'Removing the "Site Home" link from the navigation menu'),(0,o.kt)("p",null,"A plugin can modify existing navigation, and settings navigation, components from within the ",(0,o.kt)("inlineCode",{parentName:"p"},"local_[pluginname]_extend_navigation()")," function, for example:"),(0,o.kt)(r.Gf,{plugintype:"local",pluginname:"[pluginname]",example:h,description:!1,open:!0,mdxType:"Lib"}),(0,o.kt)("h3",{id:"adding-site-wide-settings-for-your-local-plugin"},"Adding Site Wide Settings For Your Local Plugin"),(0,o.kt)(r.Wy,{plugintype:"local",pluginname:"[pluginname]",example:g,description:!1,open:!0,mdxType:"SettingsPHP"}))}v.isMDXComponent=!0}}]);